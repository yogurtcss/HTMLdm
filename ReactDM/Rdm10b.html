<!DOCTYPE html>
<html lang="en">
    <!-- çº¯æ‰‹åŠ¨å®ç°Rdm10ï¼ï¼ -->
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
    </head>
    <body>
        <div id="example"></div>

        <script type="text/javascript" src="js/react.development.js"></script>
        <script type="text/javascript" src="js/react-dom.development.js"></script>
        <script type="text/javascript" src="js/prop-types.js"></script>
        <script type="text/javascript" src="js/babel.min.js"></script>
        <script type="text/babel">
            //1 å®šä¹‰ç»„ä»¶æ ‡ç­¾
            class App extends React.Component{
                constructor(props){
                    super(props);

                    //åˆå§‹çŠ¶æ€
                    this.state = {
                        todos: [ 'åƒé¥­','ç¡è§‰','æ‰“è±†è±†' ]
                    };
                    //æ”¹ç»‘this
                    this.UpdateState = this.UpdateState.bind( this );
                };
                //æ›´æ–°é€ ä½œçš„æƒé™å‡½æ•°
                UpdateState( oneState ){
                    this.state.todos.unshift( oneState ); //ç›´æ¥å¯¹åŸæ•°ç»„æ“ä½œï¼šåœ¨åŸæ•°ç»„é¦–éƒ¨æ’å…¥æ–°çŠ¶æ€
                    this.setState( this.state ); //ç›´æ¥æäº¤æ›´æ–°æ“ä½œ
                }

                render(){
                    return(
                        <div>
                            <h1>Simple TODO List</h1>
                            <Add todos={this.state.todos} UpdateState={this.UpdateState} />
                            <List todos={this.state.todos} />
                        </div>
                    );
                };
            };

            class Add extends React.Component{
                constructor(props){
                    super(props);
                    //æ”¹ç»‘this
                    this.addsth = this.addsth.bind( this );
                };
                /* å…·ä½“æ›´æ–°çŠ¶æ€çš„å‡½æ•°
                * ä½¿ç”¨çˆ¶ç»„ä»¶æš´éœ²(ä¼ é€’)å‡ºæ¥çš„ æ›´æ–°æ“ä½œæƒé™ å‡½æ•°
                *  */
                addsth(){
                    const newState = this.addInput.value.trim(); //è·å–å½“å‰è¾“å…¥æ¡†ä¸­çš„æ–°çŠ¶æ€ï¼Œtrim()å»é™¤æ–‡æœ¬é¦–å°¾çš„ç©ºç™½å­—ç¬¦
                    if( !newState ){ //æ£€æŸ¥åˆæ³•æ€§
                        console.log('æ‚¨è¾“å…¥çš„æ˜¯ç©ºä¸²ï¼è¯·æ£€æŸ¥åé‡æ–°è¾“å…¥ï¼')
                    }
                    else{
                        //ä»çˆ¶ç»„ä»¶ä¸­ä¼ è¿›æ¥çš„UpdateStateæ“ä½œæƒé™å‡½æ•°åœ¨ propsä¸­
                        this.props.UpdateState( newState ); //åœ¨å­ç»„ä»¶ä¸­ï¼Œæ‰§è¡Œæ›´æ–°æ“ä½œ
                    }
                    this.addInput.value = ''; //æ¸…é™¤å½“å‰è¾“å…¥æ¡†çš„æ–‡æœ¬å†…å®¹
                }

                render(){
                    return(
                        <div>
                            <input type="text" ref={
                                ( currInput ) => { return this.addInput = currInput }
                            }  />&nbsp;&nbsp;
                            <button onClick={this.addsth} >Add #{this.props.todos.length+1}</button>
                        </div>
                    )
                };
            };
            //Addä¼ å…¥æ•°æ®çš„å£°æ˜ã€çº¦æŸ
            Add.propTypes = {
                todos: PropTypes.array.isRequired,
                UpdateState: PropTypes.func.isRequired
            };

            class List extends React.Component{
                constructor(props){
                    super(props);
                };
                render(){
                    // map()æ–¹æ³•è€æ˜¯è®°ä¸ä½ï¼ŒğŸ‘´ä½›äº†
                    return(
                        <ul>
                            { this.props.todos.map(
                                ( onevalue,index ) => { return <li key={index} > {onevalue} </li> }
                            ) }
                        </ul>
                    )
                };
            };
            //Listå†…æ¥æ”¶æ•°æ®çš„å£°æ˜ã€çº¦æŸ
            List.propTypes = {
                todos: PropTypes.array.isRequired
            };

            //2 æ¸²æŸ“ç»„ä»¶æ ‡ç­¾
            ReactDOM.render( <App />, document.getElementById('example') );
        </script>
    </body>
</html>